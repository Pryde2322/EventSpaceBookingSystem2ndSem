<?xml version="1.0" encoding="utf-8" ?>
<mopups:PopupPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:mopups="clr-namespace:Mopups.Pages;assembly=Mopups"
    x:Class="EventSpaceBookingSystem.UserProfileMopUp"
    BackgroundColor="Transparent"
    CloseWhenBackgroundIsClicked="True">

	<AbsoluteLayout>
		<BoxView
	   BackgroundColor="Transparent"
	   AbsoluteLayout.LayoutBounds="0,0,1,1"
	   AbsoluteLayout.LayoutFlags="All">
			<BoxView.GestureRecognizers>
				<TapGestureRecognizer Tapped="OnBackgroundTapped"/>
			</BoxView.GestureRecognizers>
		</BoxView>
		<Frame
            InputTransparent="False"
            BackgroundColor="#F3F3F3"
            CornerRadius="10"
            Padding="15"
            WidthRequest="300"
            HasShadow="True"
            AbsoluteLayout.LayoutBounds="1,0.2,350,300"
            AbsoluteLayout.LayoutFlags="PositionProportional">

			<VerticalStackLayout Spacing="10">
				<!-- User Info -->
				<Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">
					<Frame HeightRequest="50" WidthRequest="50" CornerRadius="25" IsClippedToBounds="True" Padding="0" BackgroundColor="Transparent">
						<Image Source="{Binding AvatarPath}" Aspect="AspectFill">
							<Image.GestureRecognizers>
								<TapGestureRecognizer Tapped="OnAvatarTapped"/>
							</Image.GestureRecognizers>
						</Image>
					</Frame>

					<VerticalStackLayout Grid.Column="1" Margin="10,0">
						<Label Text="{Binding Email}" FontSize="14"/>
						<Label Text="{Binding Username}" FontSize="14"/>
						<StackLayout Orientation="Horizontal">
							<Label Text="status: " FontSize="12" />
							<Label Text="{Binding Status}" FontSize="12" FontAttributes="Bold"/>
						</StackLayout>
					</VerticalStackLayout>
				</Grid>

				<BoxView HeightRequest="1" BackgroundColor="#DDD" Margin="0,10"/>

				<!-- Booking Info -->
				<Frame BackgroundColor="White" CornerRadius="10" Padding="10" HasShadow="False">
					<Frame.GestureRecognizers>
						<TapGestureRecognizer Tapped="OnRecentBookingTapped" />
					</Frame.GestureRecognizers>

					<Grid RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="Auto,*">
                        <Image Grid.RowSpan="4" Source="{Binding RecentBooking.Image}" WidthRequest="60" HeightRequest="60" />
                        <Label Grid.Row="0" Grid.Column="1" Text="{Binding RecentBooking.Headline}" FontSize="16" FontAttributes="Bold" />
						<StackLayout Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
							<Label Text="Status:  " FontSize="11" />
							<Label Text="{Binding RecentBooking.Status}" FontSize="10" FontAttributes="Bold" VerticalOptions="Center"/>
						</StackLayout>
						<StackLayout Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
							<Label Text="Booking Date:  " FontSize="11" />
							<Label Text="{Binding RecentBooking.BookingDate}" FontSize="10" FontAttributes="Bold" VerticalOptions="Center"/>
						</StackLayout>
					</Grid>
				</Frame>

				<!-- Logout -->
				<Button Text="Log out" Clicked="Logout_Clicked" BackgroundColor="Transparent" TextColor="#444" HorizontalOptions="End">
					<Button.ImageSource>
						<FontImageSource FontFamily="MaterialIcons" Glyph="&#xe9ba;" Color="#444" />
					</Button.ImageSource>
				</Button>
			</VerticalStackLayout>
		</Frame>
	</AbsoluteLayout>
</mopups:PopupPage>
